## mysqldump를 활용한 백업 자동화는 어떻게 구성했나요?

<br/>

> MySQL 백업 자동화가 필요했던 이유
>

- 상용 DB는 AWS RDS를 이용하고 있으며, 주기적으로 백업을 진행하고 있다.
- 다만, 개발 DB의 경우는 온프레미스(신 개발) 서버에서 직접 실행 중이며, 백업을 하고 있지 않음.

<br/>

> MySQL 백업 방식 조사
>

1. AWS RDS의 백업 정책
    - https://docs.aws.amazon.com/ko_kr/prescriptive-guidance/latest/backup-recovery/rds.html

    1. 자동 백업 활성화시, 매일 자동으로 데이터에 대한 스냅샷을 생성 & 트랜잭션 로그를 캡쳐
        1. ex) snapshot-2024-05-10-1538 이라는 이름으로 생성.
    2. 전체 DB 인스턴스 백업
    3. 보존기간 내 언제든지 특정 시점으로 복구(PITR) 수행이 가능
        1. RDS 복원은 기존 RDS 인스턴스의 데이터가 복구되는 것이 아니라,
           복구 시점의 데이터를 바탕으로 새로운 RDS 인스턴스를 생성하는 것임.

1. mysqldump 명령어 : MySQL 설치시 내장 명령어로 바로 사용 가능
2. mysqlhotcopy : 5.7버전에서부터는 제거
3. xtrabackup : 별도 설치 필요

→ 별도의 설치를 하지 않고, 서드파티 제품이 아닌 것을 희망했으므로, mysqldump 명령어를 채택

<br/>

> 백업 구현 과정
>

1. **구 개발서버에서 실행중인 MySQL을 mysqldump를 이용해 백업 및 원격 저장소에 업로드하는 쉘 스크립트 작성**
2. 생성된 MySQL 백업 파일을 신 개발서버로 전송하는 쉘 스크립트 작성
3. 신 개발서버에서 실행중인 MySQL에 백업 파일을 import하는 쉘 스크립트 작성
4. 위에서 작성한 쉘 스크립트를 각 서버에서 Linux Crontab에 등록하여 자동화
5. 백업 복구 테스트 및 모니터링

<br/>

> 성과
>

- **백업 누락 문제 해결:** 주기적으로 자동 실행되므로 수동 작업 불필요
- **운영 부담 감소:** 개발팀이 백업을 신경 쓰지 않고 업무에 집중 가능
- **데이터 복구 신속성 향상:** 장애 발생 시 `mysql < backup.sql`로 빠르게 복구 가능
- **스토리지 절약:** 백업 파일 압축 및 보관 정책으로 불필요한 용량 낭비 방지

<br/>

> **추가적인 고려 사항 (Advanced Considerations)**
>

- **mysqldump 대신 다른 백업 방식 고려 여부**
    - `mysqldump`는 논리적 백업이라 대용량 DB에서는 성능 이슈 발생 가능
    - **대용량 DB(수십 GB 이상)일 경우 `xtrabackup` 같은 물리적 백업 도구 고려**
- **고가용성 구성 (Replication 활용)**
    - 백업 시 `read replica`에서 수행해 운영 DB 부하 최소화