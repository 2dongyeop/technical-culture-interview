## 정규화/반정규화

<br/>

> 정규화 정의
>

- 정규화는 **데이터의 중복을 최소화하고, 데이터 무결성을 유지하기 위해 테이블을 분리하는 과정**
- **목적:** 데이터 중복 제거, 이상현상(Anomaly) 방지, 데이터 무결성 보장

<br/>

> **정규화의 단계**
>

| **정규형**               | **설명**                                             | **예시**                                            |
|-----------------------|----------------------------------------------------|---------------------------------------------------|
| **1NF (제1 정규형)**      | 각 컬럼이 **원자적(Atomic) 값**을 가지도록 분해                   | 리스트형 데이터를 분리 (e.g., `phone_numbers` → 개별 row로 나눔) |
| **2NF (제2 정규형)**      | 1NF 만족 + **부분적 종속 제거** (기본키 일부에만 종속된 컬럼 제거)        | 복합키가 있는 경우, 일부 키에만 종속된 데이터 분리                     |
| **3NF (제3 정규형)**      | 2NF 만족 + **이행적 종속 제거** (A → B, B → C 형태면 B → C 제거) | `city_name` 컬럼이 `city_id`를 통해 참조되면 별도 테이블로 분리     |
| **BCNF (보이스-코드 정규형)** | 3NF 만족 + **후보키에 의존하는 컬럼만 유지**                      | 비정상적인 후보키 종속성을 제거                                 |
| **4NF (제4 정규형)**      | 다중 종속성 제거                                          | 하나의 키가 여러 개의 독립적인 다중 값을 가질 경우 분리                  |
| **5NF (제5 정규형)**      | 조인 종속성 제거                                          | 데이터를 다시 합칠 때 원본을 보장할 수 없는 경우 분리                   |

<br/>

> **반정규화 (Denormalization)란?**
>

- 반정규화는 **쿼리 성능을 최적화하기 위해 정규화를 일부 포기하고 데이터를 중복 저장하는 과정**
- **목적:** **조회 성능 개선**, 조인(Join) 최소화

<br/>

> **반정규화 기법**
>

| **기법**          | **설명**                            | **예시**                                             |
|-----------------|-----------------------------------|----------------------------------------------------|
| **중복 컬럼 추가**    | 조회 속도를 높이기 위해 자주 사용하는 데이터를 중복 저장  | `orders` 테이블에 `customer_name` 추가                   |
| **중복 테이블 생성**   | 읽기 성능을 높이기 위해 특정 데이터를 별도 테이블로 복제  | `user_summary` 테이블을 별도로 생성                         |
| **정규화된 테이블 병합** | JOIN 비용을 줄이기 위해 테이블을 합침           | `customers` + `orders` → `customer_orders` 테이블로 병합 |
| **이력 데이터 저장**   | 변경 내역을 빠르게 조회하기 위해 이전 데이터를 그대로 저장 | `order_history` 테이블을 별도로 운영                        |

<br/>

> 반정규화 활용 경험
>

- 구독 서비스에서 시작일자-종료일자를 구독 결제 내역 테이블에서 저장하고 있었지만,
- 구독자 정보를 조회시에 “자주 함께 조회되는” 이유로, 구독자 정보 테이블에도 추가하여 동기화 운영