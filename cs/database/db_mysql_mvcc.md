## MySQL MVCC 방식에 대해 설명해주세요.

> MySQL MVCC
>

- MVCC (Multi-Version Concurrency Control)는 **트랜잭션이 서로 충돌하지 않도록 여러 버전의 데이터를 관리하여 동시성을 향상**시키는 기법입니다.
- **MySQL InnoDB에서 MVCC가 동작하는 방식:**
    - `trx_id` (트랜잭션 ID)와 `undo log`를 활용하여 **각 트랜잭션이 볼 수 있는 데이터 버전을 결정**합니다.
    - **SELECT 실행 시**:
        - `READ COMMITTED`에서는 **가장 최근에 커밋된 데이터**를 읽음.
        - `REPEATABLE READ`에서는 **트랜잭션 시작 시점의 스냅샷을 유지**하여 같은 데이터를 읽음.
    - **DELETE / UPDATE 실행 시**:
        - 기존 데이터를 바로 삭제하지 않고, 새로운 버전의 데이터를 생성하며 이전 버전은 `undo log`로 보관.
    - **INSERT 시**:
        - 트랜잭션 ID를 부여하고 새로운 레코드를 추가.

→ 이러한 방식으로 **락을 최소화하면서도 일관성을 유지**할 수 있습니다.

<br/>

> Undo Log
>

- Undo Log(언두 로그)는 **트랜잭션이 데이터를 변경하기 전에 기존 데이터를 복원할 수 있도록 저장하는 로그**입니다.
- **효과**
    1. **트랜잭션 롤백(ROLLBACK) 지원**

    - 실행 중인 트랜잭션이 오류가 나거나 취소되면, **Undo Log를 이용해 원래 상태로 되돌릴 수 있음**

    2. **MVCC(다중 버전 관리) 지원**

    - 트랜잭션이 실행될 때 **과거 데이터를 유지**해야 함
    - 예를 들어, 트랜잭션 A가 실행되는 동안, 트랜잭션 B가 데이터를 수정하면 A는 **트랜잭션이 시작될 당시의 데이터를 읽어야 함** → **Undo Log가 필요함**