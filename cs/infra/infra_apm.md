## APM 활용 방안

> **APM이란 무엇인가요? APM 도구를 사용해야 하는 이유는 무엇인가요?**
>

- APM이란?
    - APM (Application Performance Management)은 애플리케이션의 성능을 모니터링하고, 분석하며, 최적화하는 과정 및 도구
- APM 도구를 사용해야 하는 이유
    1. **성능 모니터링**:
        1. 애플리케이션이 어떻게 동작하는지 실시간으로 추적하고, 시스템의 상태나 성능 저하를 감지할 수 있습니다. 서버, DB, API 등 각종 시스템 구성 요소의 성능을 모니터링합니다.
    2. **문제 진단**:
        1. APM 도구는 성능 문제나 장애를 신속하게 파악하고, 이를 해결하는 데 필요한 정보를 제공합니다.
        2. 예를 들어, 트랜잭션 추적(Distributed Tracing)을 통해 문제의 근본 원인을 찾아내고, 어느 부분에서 병목 현상이 발생했는지 알 수 있습니다.
    3. **서비스 안정성 향상**:
        1. APM 도구는 서버와 애플리케이션에서 발생하는 오류를 추적하고, 이를 조기에 발견하여 서비스의 다운타임을 최소화하는 데 기여합니다.
    4. **애플리케이션 성능 개선**:
        1. APM 도구는 애플리케이션의 코드 및 실행 경로를 분석해 병목 현상이나 비효율적인 부분을 식별하고, 이를 최적화할 수 있는 정보를 제공합니다.

<br/>

> **분산 추적(Distributed Tracing)이란 무엇인가요? 그것이 APM에서 중요한 이유는 무엇인가요?**
>

- 분산 추적이란?
    - 분산 추적(Distributed Tracing)은 여러 개의 시스템 또는 서비스가 상호 작용하는 분산 환경에서 하나의 트랜잭션(혹은 요청)이 시스템을 가로지르며 흐르는 과정을 추적하는 기법
- **분산 추적의 기본 개념:**
    1. **트랜잭션 추적**:
        1. 분산 시스템에서는 하나의 요청이 여러 서비스나 서버를 거쳐 처리될 수 있습니다.
        2. 분산 추적은 이 요청이 각 서비스에서 어떻게 처리되고 있는지 추적하여, 전체 트랜잭션 흐름을 한눈에 볼 수 있게 해줍니다.
    2. **고유 트레이스 ID**:
        1. 각 요청에는 고유한 "트레이스 ID"가 할당되며, 이 ID는 해당 요청이 여러 서비스나 서버를 지나가는 동안 계속 추적됩니다.
        2. 또한, 각 서비스마다 "스팬(span)"이라는 하위 단위로 나뉘어 각 처리 과정을 기록합니다.
- **APM에서 분산 추적의 중요성:**
    1. **복잡한 시스템 문제 진단**:
        - 마이크로서비스 아키텍처와 같은 분산 시스템에서는 여러 서비스가 상호 작용하는 복잡한 요청 경로를 추적하기 어려울 수 있습니다.
        - 분산 추적은 이러한 복잡한 경로를 시각적으로 추적하여, 각 서비스에서 발생한 성능 문제나 오류를 쉽게 파악할 수 있게 도와줍니다.
    2. **병목 현상 파악**:
        - 트랜잭션이 여러 서비스나 서버를 거치는 동안, 각 서비스에서 발생하는 지연 시간이나 오류를 추적하여 성능 병목 지점을 식별할 수 있습니다.
        - 이를 통해 어떤 서비스가 성능 저하를 일으키는지 정확하게 알 수 있습니다.
    3. **서버 간 통신 최적화**:
        - 분산 추적을 사용하면 서비스 간 통신에서 발생하는 오버헤드나 비효율적인 처리를 쉽게 파악할 수 있습니다.
        - 예를 들어, 하나의 요청이 여러 서버 간의 불필요한 통신을 거쳐야 하는 경우, 이를 최적화하는 방법을 찾아낼 수 있습니다.
    4. **서비스 상호작용 분석**:
        - 각 서비스의 트랜잭션 흐름을 분석함으로써 서비스 간의 상호작용을 이해할 수 있습니다.
        - 이를 통해 서비스 간 의존성, 호출 빈도, 지연 시간 등을 파악하고 개선할 수 있습니다.
    5. **실시간 모니터링 및 문제 해결**:
        - APM 도구는 분산 추적을 통해 실시간으로 트랜잭션의 흐름을 시각화합니다.
        - 이 데이터를 통해 실시간으로 시스템의 상태를 모니터링하고, 문제가 발생하면 즉시 원인을 분석하여 빠르게 대응할 수 있습니다.

<br/>

> **APM 도구에서 수집하는 주요 메트릭(Metrics)은 무엇이 있을까요?
이를 활용하여 성능을 어떻게 모니터링하나요?**
>

- **APM 도구에서 수집하는 주요 메트릭(Metrics)**
    1. **응답 시간 (Response Time)**
        - **설명**: 요청이 들어온 후 응답이 돌아오기까지 걸린 시간입니다. 성능 저하나 병목 현상을 식별하는 데 중요합니다.
        - **사용 목적**: 애플리케이션이 얼마나 빠르게 응답하는지 평가하고, 최적화가 필요한 부분을 식별합니다.
    2. **처리량 (Throughput)**
        - **설명**: 단위 시간(예: 초)당 처리된 요청 수입니다. 보통 초당 요청 수(RPS)나 초당 트랜잭션 수(TPS)로 측정됩니다.
        - **사용 목적**: 시스템의 처리 용량을 평가하고, 과부하 상태나 성능 저하를 감지합니다.
    3. **오류율 (Error Rate)**
        - **설명**: 시스템에서 발생하는 오류의 비율입니다. HTTP 5xx 오류나 애플리케이션 예외가 포함됩니다.
        - **사용 목적**: 서비스의 신뢰성 상태를 모니터링하고, 오류가 발생한 시점을 빠르게 파악하여 대응할 수 있습니다.
    4. **시스템 자원 사용량 (CPU, 메모리, 디스크 등)**
        - **설명**: 애플리케이션 및 서버가 사용하는 자원(예: CPU, 메모리, 디스크)의 사용량입니다.
        - **사용 목적**: 자원의 과도한 사용으로 인한 성능 저하를 예방하고, 시스템 리소스가 부족할 때 경고를 보냅니다.

<br/>

> **APM 도구에서 경고(Alert)를 설정할 때 중요한 기준은 무엇인가요? 예를 들어, 어떤 메트릭에 경고를 설정해야 할까요?**
>

- **경고 기준 설정 시 고려할 점:**
    1. **기준값의 적정성**:
        1. 각 시스템의 특징에 맞게 임계값을 설정해야 합니다.
        2. 특정 서비스는 일반적으로 더 높은 응답 시간이 허용될 수 있으므로, 서비스 별로 임계값을 다르게 설정할 수 있습니다.
    2. **알림의 빈도**:
        1. 너무 민감한 경고는 알림이 자주 발생할 수 있으므로, 너무 낮은 임계값을 설정하지 않도록 주의해야 합니다.
    3. **경고의 우선순위**:
        1. 오류율이나 시스템 다운처럼 중요한 메트릭에 대해서는 즉시 대응할 수 있는 경고가 필요하며, 상대적으로 중요도가 낮은 메트릭에 대해서는 더 넓은 범위의 임계값을 설정할 수 있습니다.
    4. **문제의 예방과 대응**:
        1. 경고를 통해 문제를 예방할 수 있도록 설정하고, 경고 발생 시 빠르게 대응할 수 있는 프로세스를 마련하는 것이 중요합니다.

- 메트릭별 경고 예시
    - **응답 시간 (Response Time)**
        - **경고 기준**: 응답 시간이 비정상적으로 길어질 때 (예: 99번째 백분위수 응답 시간이 특정 임계값을 초과할 때)
        - **예시**: "응답 시간이 2초를 초과하면 경고 발생"
        - **이유**: 사용자 경험에 직접적인 영향을 미치는 메트릭입니다. 높은 응답 시간은 서비스의 성능 저하나 병목 현상을 의미할 수 있습니다.
    - **오류율 (Error Rate)**
        - **경고 기준**: 오류 비율이 일정 비율(예: 5%) 이상일 때
        - **예시**: "HTTP 5xx 오류가 5% 이상 발생하면 경고 발생"
        - **이유**: 오류가 지속되면 시스템의 신뢰성이 크게 저하되며, 고객 경험에 심각한 영향을 줄 수 있습니다. 따라서 오류율에 대한 경고는 매우 중요한 기준입니다.
    - **시스템 자원 사용량 (CPU, 메모리 사용량)**
        - **경고 기준**: 시스템 자원(CPU, 메모리)이 일정 임계값(예: 85%, 90%)을 초과할 때
        - **예시**: "CPU 사용량이 90% 이상이면 경고 발생"
        - **이유**: 과도한 자원 사용은 시스템의 성능 저하나 다운타임을 유발할 수 있습니다. 자원 모니터링을 통해 사전에 이를 탐지하고 대응할 수 있습니다.
    - **처리량 (Throughput)**
        - **경고 기준**: 처리량이 예상보다 급격히 낮거나 높은 경우
        - **예시**: "초당 요청 수가 30% 이상 감소하면 경고 발생"
        - **이유**: 처리량이 갑자기 감소하면 시스템에 문제가 있거나 서비스가 중단된 상태일 수 있습니다. 반대로 급격히 증가하면 과부하 상태로 이어질 수 있습니다.
    - **시스템 다운 (Uptime)**
        - **경고 기준**: 시스템이 응답하지 않거나 다운되었을 때
        - **예시**: "서비스가 1분 이상 다운되면 경고 발생"
        - **이유**: 서비스의 가용성은 매우 중요하므로, 시스템이 다운되거나 응답하지 않으면 즉시 경고를 보내야 합니다.