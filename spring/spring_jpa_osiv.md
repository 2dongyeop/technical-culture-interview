## JPA OSIV(Open Session In View) 설정

<br/>

> OSIV란?
>

- OSIV (Open Session In View)는 **JPA에서 트랜잭션 범위 내에서 클라이언트에게 응답이 갈 때까지 Session을 열린 상태로 유지**하는 설정. 기본적으로 활성화되어있음.

<br/>

> OSIV 장점
>

- **지연 로딩 문제 해결**: OSIV를 사용하면 요청이 완료되기 전까지 **영속성 컨텍스트가 열려있기 때문에, 트랜잭션 범위 내에서 Lazy Loading을 안전하게 처리** 가능

<br/>

> OSIV 단점 및 주의사항
>

- **트랜잭션 범위의 장기화**
    - HTTP 요청의 전체 처리 시간 동안 영속성 컨텍스트가 열려 있으므로, **트랜잭션 범위가 예상보다 길어질 수 있습니다**.
    - 이는 **데이터베이스 연결 자원을 불필요하게 오래 점유**하게 되어 **성능 문제를 유발**할 수 있습니다.

<br/>

> **WebSocket, SSE와 같은 지속적인 연결 상황에서의 주의점**
>

- WebSocket 또는 SSE는 **클라이언트와 서버 간의 지속적인 연결**을 유지
    - → 이때 트랜잭션이 **길게 유지되거나 지속적으로 열려있는 경우** 문제가 발생할 수 있음
    - → 연결이 많아질 경우, 트랜잭션이 닫히지 않아 DB 커넥션 풀을 고갈시킬 수 있음.

<br/>

> 해결 방법
>

- **연관된 데이터를 즉시 로딩하거나 명시적으로 `flush`를 관리**하는 방식으로 문제를 해결